; n-ый аргумент функции
%define arg(n) ebp + (4 * n) + 4

; n-ая локальная переменная
%define local(n) ebp - (4 * n)

; вызов функции с любым количеством параметров (первый параметр выше всех)
%macro pcall 1-*                ; первый параметр - имя функции,
                                ; остальные - аргументы
    %rep %0-1                   ; цикл по всем параметрам
        %rotate -1              ; переходим к следующему параметру
        push dword %1           ; передаём текущий параметр
    %endrep
    %rotate -1                  ; получаем имя функции
    call %1                     ; вызываем функцию
    add esp, (%0 - 1) * 4       ; очистка стека
%endmacro
